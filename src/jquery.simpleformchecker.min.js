/**
 *	@author Ioulian Alexeev
 *	@date 08.11.2011
 *	@description Fast and versatile form checker script.
 *	@version 0.1.8
 */
 function Sfc(){"use strict";var regexChecks={Email:{Class:"email",ErrorText:"This must be a valid email address",Pattern:new RegExp(/^(("[\w-\s]+")|([\w\-]+(?:\.[\w\-]+)*)|("[\w\-\s]+")([\w\-]+(?:\.[\w\-]+)*))(@((?:[\w\-]+\.)*\w[\w\-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i)},Url:{Class:"url",ErrorText:"This must be a valid url",Pattern:new RegExp(/(^|\s)((https?:\/\/)?[\w\-]+(\.[\w\-]+)+\.?(:\d+)?(\/\S*)?)/i)},Ip:{Class:"ip",ErrorText:"This must be a valid IP number",Pattern:new RegExp(/^((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))*$/i)},Number:{Class:"number",ErrorText:"This must contain only numbers",Pattern:new RegExp(/^[0-9]*$/i)},Characters:{Class:"characters",ErrorText:"This must contain only characters",Pattern:new RegExp(/^[a-zA-Z]*$/i)},Day:{Class:"day",ErrorText:"This must be a valid day",Pattern:new RegExp(/^([1-9]|[1-2][0-9]|3[01])$/i)},Month:{Class:"month",ErrorText:"This must be a valid month",Pattern:new RegExp(/^(([0]{0,1}[1-9])|(1[0-2]))$/i)},Year:{Class:"year",ErrorText:"This must be a valid year",Pattern:new RegExp(/^(19|20)\d\d$/i)},Date:{Class:"date",ErrorText:"This must be a valid date (DD/MM/YYYY)",Pattern:new RegExp(/^((0?[1-9]|[12][0-9]|3[01])[\- \/.](0?[1-9]|1[012])[\- \/.](19|20)?[0-9]{2})*$/i)},UsDate:{Class:"usdate",ErrorText:"This must be a valid date (MM/DD/YYYY)",Pattern:new RegExp(/^((0?[1-9]|1[012])[\- \/.](0?[1-9]|[12][0-9]|3[01])[\- \/.](19|20)?[0-9]{2})*$/i)},MysqlDate:{Class:"mysqldate",ErrorText:"This must be a valid date (YYYY-MM-DD)",Pattern:new RegExp(/^((19|20)?[0-9]{2}[\-](0?[1-9]|1[012])[\-](0?[1-9]|[12][0-9]|3[01]))*$/i)}},otherChecks={Length:{Class:"length",MinErrorText:"The minimum required number of characters is [[allowed]]",MaxErrorText:"The maximum allowed number of characters is [[allowed]]",EqualErrorText:"The number of characters must be [[allowed]]",CounterTextMax:"[[current]] <= [[max]]",CounterTextMin:"[[current]] >= [min]",CounterTextMinMax:"[min] <= [[current]] <= [max]",CounterTextEqual:"[[current]] == [equal]"},Identical:{Class:"identical",ErrorText:"These fields must match"},PasswordStrength:{Class:"strength",ErrorText:"Your password is too weak",Notifications:["Very weak","Weak","Better","Medium","Strong","Strongest"]}},settings={asterix:"<span class=\"asterix\">*</span>",errorMessage:"<p class=\"errorMessage\">[[text]]</p>",requiredClass:"required",checkOnChange:true,updateOnType:true,scrollToErrorField:true,animationTime:250,scrollTime:500,emptyErrorText:"This field is required",formErrorText:"Please check the highlighted fields"},self=this,errorField=null,form=null,error=false,inputs=["input","select","textarea"];Sfc.prototype.construct=function(f,options){form=f;self.handleOptions(options);self.init();};this.init=function(){var i,inputCount=inputs.length;for(i=0;i<inputCount;i+=1){$(form).find(inputs[i]).each(function(){if(settings.asterix!==""){if($(this).hasClass(settings.requiredClass)){$(this).parent(":first").append(settings.asterix);}}if(settings.checkOnChange){$(this).bind("change",function(){self.checkField($(this));});}if(inputs[i]==="input"){if(settings.updateOnType){if($(this).hasClass(otherChecks.Length.Class)){$(this).bind("keyup",function(){self.validateFieldLength($(this),true);});self.validateFieldLength($(this),true);}if($(this).hasClass(otherChecks.PasswordStrength.Class)){$(this).bind("keyup",function(){self.checkPasswordStrength($(this),true);});}}}});}$(form).submit(function(){return self.checkForm();});};this.handleOptions=function(options){var param,check;if(options!==null){for(param in options){if(settings[param]!==null){settings[param]=options[param];}}}if(options.errorText!==null){for(check in options.errorText){if(regexChecks[check]!==null){regexChecks[check].ErrorText=options.errorText[check];}}for(check in options.errorText){if(otherChecks[check]!==null){otherChecks[check].ErrorText=options.errorText[check];}}}};this.checkForm=function(){var i,errorContainer,inputCount=inputs.length;error=false;for(i=0;i<inputCount;i+=1){$(form).find(inputs[i]).each(function(){self.checkField($(this));});}if(error){if(settings.scrollToErrorField){self.scrollToErrorField();}errorContainer=$(form).data("errmessage");if(typeof errorContainer!=="undefined"){$("#"+errorContainer).text(settings.formErrorText);}return false;}return true;};this.scrollToErrorField=function(){$("html, body").animate({scrollTop:errorField.offset().top},settings.scrollTime);errorField.focus();};this.checkField=function(object){var check,err=false;if(!err&&object.hasClass("required")&&object.val()===""){err=self.addError(object,settings.emptyErrorText);}else if(!err&&self.validateFieldLength(object)){err=true;}else if(!err&&self.validateIdentical(object)){err=true;}else if(!err&&self.checkPasswordStrength(object)){err=true;}if(!err){if(regexChecks!==null){for(check in regexChecks){if(object.hasClass(regexChecks[check].Class)&&!regexChecks[check].Pattern.test(object.val())&&object.val()!==""){err=self.addError(object,regexChecks[check].ErrorText);}}}}if(!err){self.removeError(object);}};this.checkPasswordStrength=function(object,updateCounterOnly){var score=0,err=false,value=$(object).val(),descContainer=$("#"+$(object).data("desc")),minStrength=$(object).data("minstrength");updateCounterOnly=(typeof updateCounterOnly==="undefined")?false:updateCounterOnly;if(value.length>6){score+=1;}if(value.match(/[a-z]/)&&value.match(/[A-Z]/)){score+=1;}if(value.match(/\d+/)){score+=1;}if(value.match(/\.[!,@,#,$,%,\^,&,*,?,_,~,-,(,)]/)){score+=1;}if(value.length>12){score+=1;}if(descContainer.length===1){$(descContainer).text(otherChecks.PasswordStrength.Notifications[score]).removeClass().addClass("strength"+score);}if(typeof minStrength!=="undefined"&&!updateCounterOnly){if(score<minStrength){err=self.addError(object,otherChecks.PasswordStrength.ErrorText);}}return err;};this.validateIdentical=function(object){var equalToField,err=false,equalTo=$(object).data("equalto");if(typeof equalTo!=="undefined"){equalToField=$("#"+equalTo);if(equalToField.length===1){if($(equalToField).val()!==$(object).val()){err=self.addError(object,otherChecks.Identical.ErrorText);self.addError(equalToField,otherChecks.Identical.ErrorText);}else{self.removeError(equalToField);}}}return err;};this.validateFieldLength=function(object,updateCounterOnly){updateCounterOnly=(typeof updateCounterOnly==="undefined")?false:updateCounterOnly;var err=false,counterText="",checkWhat="",maxChars=$(object).data("max"),minChars=$(object).data("min");if(object.hasClass(otherChecks.Length.Class)&&(object.attr("type")==="text"||object.attr("type")==="password")){if(typeof maxChars!=="undefined"&&typeof minChars==="undefined"){counterText=otherChecks.Length.CounterTextMax;checkWhat="maxchars";}else if(typeof minChars!=="undefined"&&typeof maxChars==="undefined"){counterText=otherChecks.Length.CounterTextMin;checkWhat="minchars";}else if(typeof maxChars!=="undefined"&&typeof minChars!=="undefined"){if(minChars>=0){if(maxChars>minChars){counterText=otherChecks.Length.CounterTextMinMax;checkWhat="bothchars";}else if(maxChars===minChars){counterText=otherChecks.Length.CounterTextEqual;checkWhat="equalchars";}}}if(!err&&(checkWhat==="maxchars"||checkWhat==="bothchars")&&object.val().length>maxChars){err=(!updateCounterOnly)?self.addError(object,otherChecks.Length.MaxErrorText.replace("[[allowed]]",maxChars)):true;}else if(!err&&(checkWhat==="minchars"||checkWhat==="bothchars")&&object.val().length<minChars){err=(!updateCounterOnly)?self.addError(object,otherChecks.Length.MinErrorText.replace("[[allowed]]",minChars)):true;}else if(!err&&checkWhat==="equalchars"&&object.val().length!==maxChars){err=(!updateCounterOnly)?self.addError(object,otherChecks.Length.EqualErrorText.replace("[[allowed]]",maxChars)):true;}self.updateCounter(object,counterText,maxChars,minChars,err);}return err;};this.updateCounter=function(object,counterText,max,min,err){var counter=$("#"+$(object).data("counter"));if(counter.length===1){min=(typeof min==="undefined")?"":min;max=(typeof max==="undefined")?"":max;$(counter).text(counterText.replace("[[min]]",min).replace("[[current]]",$(object).val().length).replace("[[max]]",max).replace("[[equal]]",max));if(err){$(counter).addClass("error");}else{$(counter).removeClass("error");}}};this.addError=function(object,text){var errorMessageElement;if(errorField===null){errorField=object;}if(text!==null||text!==""){errorMessageElement=$("#"+$(object).data("errmessage"));if(errorMessageElement.length===1){if(errorMessageElement.text()===""){errorMessageElement.hide().text(text).slideDown(settings.animationTime);}}else{errorMessageElement=self.getErrorElement(object);if(errorMessageElement.length===0){$(settings.errorMessage.replace("[[text]]",text)).hide().appendTo(object.parent(":first")).slideDown(settings.animationTime);}else{errorMessageElement.text(text);}}}object.addClass("error");error=true;return true;};this.removeError=function(object){var errorMessageElement;object.removeClass("error");errorMessageElement=$("#"+$(object).data("errmessage"));if(errorMessageElement.length===1){errorMessageElement.slideUp(settings.animationTime);}else{self.getErrorElement(object).slideUp(settings.animationTime).queue(function(){$(this).remove();});}};this.getErrorElement=function(object){return object.parent(":first").children($(settings.errorMessage)[0].nodeName+"."+$(settings.errorMessage).attr("class"));};}(function($){"use strict";jQuery.fn.SimpleFormChecker=function(options){var i,len,form,args,sfc;for(i=0,len=this.length;i<len;i+=1){form=$(this[i]);args=options||{};sfc=new Sfc().construct(form,args);}};}(jQuery));