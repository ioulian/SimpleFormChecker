/**
 *	@author Ioulian Alexeev
 *	@date 08.11.2011
 *	@description Fast and versatile form checker script.
 *	@version 0.1.6
 */
(function(a){"use strict";jQuery.fn.SimpleFormChecker=function(b){var c,d,e,f;for(c=0,d=this.length;c<d;c+=1){e=a(this[c]);f=b||{};a.SimpleFormChecker.construct(e,f)}};a.SimpleFormChecker={regexChecks:{Email:{Class:"email",ErrorText:"This must be a valid email address",Pattern:new RegExp(/^(("[\w-\s]+")|([\w\-]+(?:\.[\w\-]+)*)|("[\w\-\s]+")([\w\-]+(?:\.[\w\-]+)*))(@((?:[\w\-]+\.)*\w[\w\-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i)},Url:{Class:"url",ErrorText:"This must be a valid url",Pattern:new RegExp(/(^|\s)((https?:\/\/)?[\w\-]+(\.[\w\-]+)+\.?(:\d+)?(\/\S*)?)/i)},Ip:{Class:"ip",ErrorText:"This must be a valid IP number",Pattern:new RegExp(/^((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))*$/i)},Number:{Class:"number",ErrorText:"This must contain only numbers",Pattern:new RegExp(/^[0-9]*$/i)},Characters:{Class:"characters",ErrorText:"This must contain only characters",Pattern:new RegExp(/^[a-zA-Z]*$/i)},Day:{Class:"day",ErrorText:"This must be a valid day",Pattern:new RegExp(/^([1-9]|[1-2][0-9]|3[01])$/i)},Month:{Class:"month",ErrorText:"This must be a valid month",Pattern:new RegExp(/^(([0]{0,1}[1-9])|(1[0-2]))$/i)},Year:{Class:"year",ErrorText:"This must be a valid year",Pattern:new RegExp(/^(19|20)\d\d$/i)},Date:{Class:"date",ErrorText:"This must be a valid date (DD/MM/YYYY)",Pattern:new RegExp(/^((0?[1-9]|[12][0-9]|3[01])[\- \/.](0?[1-9]|1[012])[\- \/.](19|20)?[0-9]{2})*$/i)},UsDate:{Class:"usdate",ErrorText:"This must be a valid date (MM/DD/YYYY)",Pattern:new RegExp(/^((0?[1-9]|1[012])[\- \/.](0?[1-9]|[12][0-9]|3[01])[\- \/.](19|20)?[0-9]{2})*$/i)},MysqlDate:{Class:"mysqldate",ErrorText:"This must be a valid date (YYYY-MM-DD)",Pattern:new RegExp(/^((19|20)?[0-9]{2}[\-](0?[1-9]|1[012])[\-](0?[1-9]|[12][0-9]|3[01]))*$/i)}},otherChecks:{Length:{Class:"length",MinErrorText:"The minimum required number of characters is [ALLOWED]",MaxErrorText:"The maximum allowed number of characters is [ALLOWED]",EqualErrorText:"The number of characters must be [ALLOWED]",CounterTextMax:"[CURRENT] <= [MAX]",CounterTextMin:"[MIN] <= [CURRENT]",CounterTextMinMax:"[MIN] <= [CURRENT] <= [MAX]",CounterTextEqual:"[CURRENT] == [EQUAL]"},Identical:{Class:"identical",ErrorText:"These fields must match"},PasswordStrength:{Class:"strength",ErrorText:"Your password is too weak",Notifications:["Very weak","Weak","Better","Medium","Strong","Strongest"]}},settings:{asterix:"*",errorTextElement:"p",checkOnChange:true,scrollToTop:true,showErrorText:true,animationTime:250,scrollTime:500,emptyErrorText:"This field is required",formErrorText:"Please check the highlighted fields"},firstErrorField:null,form:null,error:false,construct:function(a,b){this.form=a;this.handleOptions(b);this.init()},init:function(){if(this.settings.asterix!==""&&!a(this.form).hasClass("noAsterix")){a(this.form).find("input.required, select.required, textarea.required").each(function(){a(this).parent(":first").append('<span class="req">'+a.SimpleFormChecker.settings.asterix+"</span>")})}if(this.settings.checkOnChange){a(this.form).find("input, select, textarea").change(function(){a.SimpleFormChecker.checkField(a(this))})}a(this.form).submit(function(){return a.SimpleFormChecker.checkForm(this)});a(this.form).find("input."+this.otherChecks.Length.Class).keyup(function(){a.SimpleFormChecker.validateFieldLength(a(this),true)});a(this.form).find("input."+this.otherChecks.PasswordStrength.Class).keyup(function(){a.SimpleFormChecker.checkPasswordStrength(a(this),true)})},handleOptions:function(a){var b,c;if(a!==null){for(b in a){if(this.settings[b]!==null){this.settings[b]=a[b]}}}if(a.errorText!==null){for(c in a.errorText){if(this.regexChecks[c]!==null){this.regexChecks[c].ErrorText=a.errorText[c]}}for(c in a.errorText){if(this.otherChecks[c]!==null){this.otherChecks[c].ErrorText=a.errorText[c]}}}},checkForm:function(b){this.error=false;this.firstErrorField=null;a(b).find("input, select, textarea").each(function(){a.SimpleFormChecker.checkField(a(this))});if(this.error){if(this.settings.scrollToTop){a("html, body").animate({scrollTop:this.firstErrorField.offset().top},this.settings.scrollTime)}if(this.firstErrorField!==null){a(this.firstErrorField).focus()}var c=a(b).data("errmessage");if(typeof c!=="undefined"){a("#"+c).text(this.settings.formErrorText)}return false}return true},checkField:function(a){var b,c=false;if(!c&&a.hasClass("required")&&a.val()===""){c=this.addError(a,this.settings.emptyErrorText)}else if(!c&&this.validateFieldLength(a)){c=true}else if(!c&&this.validateIdentical(a)){c=true}else if(!c&&this.checkPasswordStrength(a)){c=true}if(!c){if(this.regexChecks!==null){for(b in this.regexChecks){if(a.hasClass(this.regexChecks[b].Class)&&!this.regexChecks[b].Pattern.test(a.val())&&a.val()!==""){c=this.addError(a,this.regexChecks[b].ErrorText)}}}}if(!c){this.removeError(a)}},checkPasswordStrength:function(b,c){var d=0,e=false,f=a(b).val(),g=a("#"+a(b).data("desc")),h=a(b).data("minstrength");c=typeof c==="undefined"?false:c;if(f.length>6){d+=1}if(f.match(/[a-z]/)&&f.match(/[A-Z]/)){d+=1}if(f.match(/\d+/)){d+=1}if(f.match(/\.[!,@,#,$,%,\^,&,*,?,_,~,-,(,)]/)){d+=1}if(f.length>12){d+=1}if(g.length===1){a(g).text(this.otherChecks.PasswordStrength.Notifications[d]).removeClass().addClass("strength"+d)}if(typeof h!=="undefined"&&!c){if(d<h){e=this.addError(b,this.otherChecks.PasswordStrength.ErrorText)}}return e},validateIdentical:function(b){var c,d=false,e=a(b).data("equalto");if(typeof e!=="undefined"){c=a("#"+e);if(c.length===1){if(a(c).val()!==a(b).val()){d=this.addError(b,this.otherChecks.Identical.ErrorText);this.addError(c,this.otherChecks.Identical.ErrorText)}else{this.removeError(c)}}}return d},validateFieldLength:function(b,c){c=typeof c==="undefined"?false:c;var d=false,e="",f="",g=a(b).data("max"),h=a(b).data("min");if(b.hasClass(this.otherChecks.Length.Class)&&(b.attr("type")==="text"||b.attr("type")==="password")){if(typeof g!=="undefined"&&typeof h==="undefined"){e=this.otherChecks.Length.CounterTextMax;f="maxchars"}else if(typeof h!=="undefined"&&typeof g==="undefined"){e=this.otherChecks.Length.CounterTextMin;f="minchars"}else if(typeof g!=="undefined"&&typeof h!=="undefined"){if(h>=0){if(g>h){e=this.otherChecks.Length.CounterTextMinMax;f="bothchars"}else if(g===h){e=this.otherChecks.Length.CounterTextEqual;f="equalchars"}}}if(!d&&(f==="maxchars"||f==="bothchars")&&b.val().length>g){d=!c?this.addError(b,this.otherChecks.Length.MaxErrorText.replace("[ALLOWED]",g)):true}else if(!d&&(f==="minchars"||f==="bothchars")&&b.val().length<h){d=!c?this.addError(b,this.otherChecks.Length.MinErrorText.replace("[ALLOWED]",h)):true}else if(!d&&f==="equalchars"&&b.val().length!==g){d=!c?this.addError(b,this.otherChecks.Length.EqualErrorText.replace("[ALLOWED]",g)):true}this.updateCounter(b,e,g,h,d)}return d},updateCounter:function(b,c,d,e,f){var g=a("#"+a(b).data("counter"));if(g.length===1){e=typeof e==="undefined"?"":e;d=typeof d==="undefined"?"":d;a(g).text(c.replace("[MIN]",e).replace("[CURRENT]",a(b).val().length).replace("[MAX]",d).replace("[EQUAL]",d));if(f){a(g).addClass("error")}else{a(g).removeClass("error")}}},addError:function(b,c){if(this.settings.scrollToTop&&this.firstErrorField===null){this.firstErrorField=b}if(this.settings.showErrorText&&c!==null){if(b.parent(":first").children(this.settings.errorTextElement+".errorText").length===0){var d="<"+this.settings.errorTextElement+' class="errorText">'+c+"</"+this.settings.errorTextElement+">";a(d).hide().appendTo(b.parent(":first")).slideDown(this.settings.animationTime)}else{b.parent(":first").children(this.settings.errorTextElement+".errorText").text(c)}}b.addClass("error");this.error=true;return true},removeError:function(b){b.removeClass("error");b.parent(":first").children(this.settings.errorTextElement+".errorText").slideUp(this.settings.animationTime).queue(function(){a(this).remove()})}}})(jQuery)